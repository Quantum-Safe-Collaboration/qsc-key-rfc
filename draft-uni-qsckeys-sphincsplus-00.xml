<?xml version='1.0' encoding='utf-8'?>
<!-- This template is for creating an Internet Draft using xml2rfc,
which is available here: http://xml.resource.org. -->
<!DOCTYPE rfc SYSTEM "rfc2629-xhtml.ent">
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt'?>
<!-- used by XSLT processors --> 
<!-- For a complete list and description of processing instructions (PIs), 
please see http://xml.resource.org/authoring/README.html. -->
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" category="info" docName="draft-uni-qsckeys-sphincsplus-00" ipr="trust200902" obsoletes="" updates="" submissionType="IETF" xml:lang="en" tocInclude="true" tocDepth="4" symRefs="true" sortRefs="true" version="3">
    <!-- xml2rfc v2v3 conversion 2.38.1 -->
    <!-- category values: std, bcp, info, exp, and historic
    ipr values: trust200902, noModificationTrust200902, noDerivativesTrust200902,
    or pre5378Trust200902
    you can add the attributes updates="NNNN" and obsoletes="NNNN"
    they will automatically be output with "(if approved)" -->

    <!-- ***** FRONT MATTER ***** -->

    <front>
        <!-- The abbreviated title is used in the page header - it is only necessary if the
        full title is longer than 39 characters -->

        <title abbrev="QSC Keys for SPHINCS-PLUS"> QSC Keys for SPHINCS-PLUS</title>
        <seriesInfo name="Individual-Draft" value="draft-uni-qsckeys-sphincsplus-00" />
        <!-- add 'role="editor"' below for the editors if appropriate -->

        <author fullname="Christine van Vredendaal" surname="Vredendaal">
            <organization>NXP Semiconductors</organization>
            <address>
                <postal>
                    <street>High Tech Campus 60</street>
                    <!-- Reorder these if your country does things differently -->
                    <city>AE Eindhoven</city>
                    <region />
                    <code>5656</code>
                    <country>NL</country>
                </postal>
                <phone>+44 7889 488 335</phone>
                <email>cvvrede@gmail.com</email>
                <!-- uri and facsimile elements may also be added -->
            </address>
        </author>
        <!-- Another author who claims to be an editor -->

        <author fullname="Silvio Dragone" surname="Dragone">
            <organization>IBM Research GmbH</organization>
            <address>
                <postal>
                    <street>Saeumerstrasse 4 </street>
                    <!-- Reorder these if your country does things differently -->

                    <city>Rueschlikon</city>
                    <region />
                    <code>8803</code>
                    <country>CH</country>
                </postal>
                <email>sid@zurich.ibm.com</email>
                <!-- uri and facsimile elements may also be added -->
            </address>
        </author>

        <author fullname="Basil Hess" surname="Hess">
            <organization>IBM Research GmbH</organization>
            <address>
                <postal>
                    <street>Saeumerstrasse 4 </street>
                    <!-- Reorder these if your country does things differently -->

                    <city>Rueschlikon</city>
                    <region />
                    <code>8803</code>
                    <country>CH</country>
                </postal>
                <email>bhe@zurich.ibm.com</email>
                <!-- uri and facsimile elements may also be added -->
            </address>
        </author>

        <author fullname="Tamas Visegrady" surname="Visegrady">
            <organization>IBM Research GmbH</organization>
            <address>
                <postal>
                    <street>Saeumerstrasse 4 </street>
                    <!-- Reorder these if your country does things differently -->

                    <city>Rueschlikon</city>
                    <region />
                    <code>8803</code>
                    <country>CH</country>
                </postal>
                <email>tvi@zurich.ibm.com</email>
                <!-- uri and facsimile elements may also be added -->
            </address>
        </author>

        <author fullname="Michael Osborne" surname="Osborne">
            <organization>IBM Research GmbH</organization>
            <address>
                <postal>
                    <street>Saeumerstrasse 4 </street>
                    <!-- Reorder these if your country does things differently -->

                    <city>Rueschlikon</city>
                    <region />
                    <code>8803</code>
                    <country>CH</country>
                </postal>
                <email>osb@zurich.ibm.com</email>
                <!-- uri and facsimile elements may also be added -->
            </address>
        </author>

        <author fullname="Dieter Bong" surname="Bong">
            <organization>Utimaco IS GmbH</organization>
            <address>
                <postal>
                    <street>Germanusstrasse 4 </street>
                    <!-- Reorder these if your country does things differently -->

                    <city>Aachen</city>
                    <region />
                    <code>52080</code>
                    <country>DE</country>
                </postal>
                <email>dieter.bong@utimaco.com</email>
                <!-- uri and facsimile elements may also be added -->
            </address>
        </author>


        <author fullname="Joppe Bos" surname="Bos">
            <organization>NXP Semiconductors</organization>
            <address>
                <postal>
                    <street>High Tech Campus 60</street>
                    <!-- Reorder these if your country does things differently -->
                    <city>AE Eindhoven</city>
                    <region />
                    <code>5656</code>
                    <country>NL</country>
                </postal>
                <phone>+44 7889 488 335</phone>
                <email>joppe.bos@nxp.com</email>
                <!-- uri and facsimile elements may also be added -->
            </address>
        </author>


        <date year="2022" />
        <!-- If the month and year are both specified and are the current ones, xml2rfc will fill
        in the current day for you. If only the current year is specified, xml2rfc will fill
        in the current day and month for you. If the year is not the current one, it is
        necessary to specify at least a month (xml2rfc assumes day="1" if not specified for the
        purpose of calculating the expiry date).  With drafts it is normally sufficient to
        specify just the year. -->

        <!-- Meta-data Declarations -->

        <area>General</area>
        <workgroup>Internet Engineering Task Force</workgroup>
        <!-- WG name at the upperleft corner of the doc,
        IETF is fine for individual submissions.
        If this element is not present, the default is "Network Working Group",
        which is used by the RFC Editor as a nod to the history of the IETF. -->

        <keyword>template</keyword>
        <!-- Keywords will be incorporated into HTML output
        files in a meta tag but they have no effect on text or nroff
        output. If you submit your draft to the RFC Editor, the
        keywords will be used for the search engine. -->

        <abstract>
            <t>This proposal defines key management approaches for the Quantum Safe Cryptographic (QSC) algorithm SPHINCS+ (or SPHINCS-PLUS) which has been selected for standardization by the NIST Post Quantum Cryptography (PQC) process.
            This includes key identification, key serialization, and key compression. The purpose is to provide guidance such that 
            the adoption of quantum-safe algorithms is not hampered with the fragmented evolution of necessary key management standards. 
            Early definition of key material standards will help expedite the adoption of new quantum safe algorithms at the same time as improving interoperability between implementations and minimizing divergence across standards. </t>
        </abstract>
    </front>
    <middle>
        <section numbered="true" toc="default">
            <name>Introduction</name>
            <t>QSC algorithms being standardized in the NIST PQC Process have evolved through several rounds and iterations.  Keys are neither easily identifiable nor compatible across rounds.  It is also expected that algorithms will evolve after final candidates have been selected.  The lack of binary compatibility between algorithm versions and variants means that it is important to clearly identify key material.  Parallel to the NIST process, industry is evaluating the impact of adopting new PQC algorithms, in particular key management.  Here it is important to define and standardize key serialization and encoding formats.  Finally, we have seen that many platforms and protocols are very constrained when it comes to the amount of memory or space available for key objects.  This makes it important to define and standardize key compression formats.  This proposal addresses aspects of key identification, key serialization, and key compression for the selected NIST PQC standard SPHINCS-PLUS.</t>
            <section numbered="true" toc="default">
                <name>Requirements Language</name>
                <t>
                    The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
                    "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
                    document are to be interpreted as described in
                    <xref target="RFC2119" format="default">RFC 2119</xref>
                    .
                </t>
            </section>

            <!-- This PI places the pagebreak correctly (before the section title) in the text output. -->

            <section numbered="true" toc="default">
                <name>Algorithm Identification</name>
                <t>Algorithm identification is important for several reasons: </t>
                <ul spacing="compact">
                    <li>Managing a smooth transition from early adoption algorithm versions to production versions where there is no compatibility.</li>
                    <li>Supporting different algorithm versions from different NIST rounds</li>
                    <li>Identifying different key serialization strategies </li>
                    <li>Identifying compressed and uncompressed keys</li>
                </ul>
                <t>The current standardization of quantum-safe algorithms does not address the definition of serialization structures for keys. As a result, it has become commonplace for the cryptographic community working on and with these algorithms to define their own approaches. This leads to proprietary and internal representations for key material. This has certain advantages in terms of ease of experimentation while focusing on finding the best-performing QSC algorithms. In terms of longer-term support where algorithm versions change this is a problem.
                This proposal defines in section 2 a long-term structured key representation format useful to address the goals outlined in 1.2.</t>
            </section>

            <section numbered="true" toc="default">
                <name>Algorithm and Algorithm Parameter Object Identifier</name>
                <t>
                    Algorithm and algorithm parameter information shall have ASN.1 type AlgorithmIdentifier as given in
                    <xref target="RFC5280" format="default"></xref>
                    and shall be extended by an pqcAlgorithmParameterName type in the optional parameters field:
                </t>
                <artwork align="left" name="" type="" alt="">
                    <![CDATA[
AlgorithmIdentifier ::=  SEQUENCE {
    algorithm  OBJECT IDENTIFIER, - OID: algorithm and algo parameter 
    parameters pqcAlgorithmParameterName OPTIONAL
}
pqcAlgorithmParameterName ::= PrintableString
]]>
                </artwork>

            </section>
	    
        </section>

        <section numbered="true" toc="default">
            <name>Overview of PQC algorithm and parameter OIDs</name>
	    <t>SPHINCS-PLUS consists of six different parameter sets. This memo attributes a name and a placeholder for an OID to the different parameter sets of SPHINCS-PLUS. The following table gives an overview of the possible OIDs in the algorithm field and possible parameters set names in the parameters field of the AlgorithmIdentifier type. Each name or OID represents a single parameter set of given security. Details can be found in the next section.</t>
	    <figure anchor="PQCalgorithmOIDs">
                <artwork align="left" name="" type="" alt="">
                    <![CDATA[
|=========+=====+======================================================|
| SPHINCS-PLUS (PQC Digital Signature)                                 |
|=========+=====+======================================================|
| sphincsplus-sha-128s-r3                                              |
|---------+-----+------------------------------------------------------|
|         |ASN.1| {..*.. pqc-ds-sphincsplus sphincsplus-sha-128s-r3}   |
|         |dot. |                                                      |
|---------+-----+------------------------------------------------------|
| sphincsplus-shake-128s-r3                                            |
|---------+-----+------------------------------------------------------|
|         |ASN.1| {..*.. pqc-ds-sphincsplus sphincsplus-shake-128s-r3} |
|         |dot. |                                                      |
|---------+-----+------------------------------------------------------|
| sphincsplus-haraka-128s-r3                                           |
|---------+-----+------------------------------------------------------|
|         |ASN.1| {..*.. pqc-ds-sphincsplus sphincsplus-haraka-128s-r3}|
|         |dot. |                                                      |
|---------+-----+------------------------------------------------------|
| sphincsplus-sha-128f-r3                                              |
|---------+-----+------------------------------------------------------|
|         |ASN.1| {..*.. pqc-ds-sphincsplus sphincsplus-sha-128f-r3}   |
|         |dot. |                                                      |
|---------+-----+------------------------------------------------------|
| sphincsplus-shake-128f-r3                                            |
|---------+-----+------------------------------------------------------|
|         |ASN.1| {..*.. pqc-ds-sphincsplus sphincsplus-shake-128f-r3} |
|         |dot. |                                                      |
|---------+-----+------------------------------------------------------|
| sphincsplus-haraka-128f-r3                                           |
|---------+-----+------------------------------------------------------|
|         |ASN.1| {..*.. pqc-ds-sphincsplus sphincsplus-haraka-128f-r3}|
|         |dot. |                                                      |
|---------+-----+------------------------------------------------------|
| sphincsplus-sha-192s-r3                                              |
|---------+-----+------------------------------------------------------|
|         |ASN.1| {..*.. pqc-ds-sphincsplus sphincsplus-sha-192s-r3}   |
|         |dot. |                                                      |
|---------+-----+------------------------------------------------------|
| sphincsplus-shake-192s-r3                                            |
|---------+-----+------------------------------------------------------|
|         |ASN.1| {..*.. pqc-ds-sphincsplus sphincsplus-shake-192s-r3} |
|         |dot. |                                                      |
|---------+-----+------------------------------------------------------|
| sphincsplus-haraka-192s-r3                                           |
|---------+-----+------------------------------------------------------|
|         |ASN.1| {..*.. pqc-ds-sphincsplus sphincsplus-haraka-192s-r3}|
|         |dot. |                                                      |
|---------+-----+------------------------------------------------------|
| sphincsplus-sha-192f-r3                                              |
|---------+-----+------------------------------------------------------|
|         |ASN.1| {..*.. pqc-ds-sphincsplus sphincsplus-sha-192f-r3}   |
|         |dot. |                                                      |
|---------+-----+------------------------------------------------------|
| sphincsplus-shake-192f-r3                                            |
|---------+-----+------------------------------------------------------|
|         |ASN.1| {..*.. pqc-ds-sphincsplus sphincsplus-shake-192f-r3} |
|         |dot. |                                                      |
|---------+-----+------------------------------------------------------|
| sphincsplus-haraka-192f-r3                                           |
|---------+-----+------------------------------------------------------|
|         |ASN.1| {..*.. pqc-ds-sphincsplus sphincsplus-haraka-192f-r3}|
|         |dot. |                                                      |
|---------+-----+------------------------------------------------------|
| sphincsplus-sha-256s-r3                                              |
|---------+-----+------------------------------------------------------|
|         |ASN.1| {..*.. pqc-ds-sphincsplus sphincsplus-sha-256s-r3}   |
|         |dot. |                                                      |
|---------+-----+------------------------------------------------------|
| sphincsplus-shake-256s-r3                                            |
|---------+-----+------------------------------------------------------|
|         |ASN.1| {..*.. pqc-ds-sphincsplus sphincsplus-shake-256s-r3} |
|         |dot. |                                                      |
|---------+-----+------------------------------------------------------|
| sphincsplus-haraka-256s-r3                                           |
|---------+-----+------------------------------------------------------|
|         |ASN.1| {..*.. pqc-ds-sphincsplus sphincsplus-haraka-256s-r3}|
|         |dot. |                                                      |
|---------+-----+------------------------------------------------------|
| sphincsplus-sha-256f-r3                                              |
|---------+-----+------------------------------------------------------|
|         |ASN.1| {..*.. pqc-ds-sphincsplus sphincsplus-sha-256f-r3}   |
|         |dot. |                                                      |
|---------+-----+------------------------------------------------------|
| sphincsplus-shake-256f-r3                                            |
|---------+-----+------------------------------------------------------|
|         |ASN.1| {..*.. pqc-ds-sphincsplus sphincsplus-shake-256f-r3} |
|         |dot. |                                                      |
|---------+-----+------------------------------------------------------|
| sphincsplus-haraka-256f-r3                                           |
|---------+-----+------------------------------------------------------|
|         |ASN.1| {..*.. pqc-ds-sphincsplus sphincsplus-haraka-256f-r3}|
|         |dot. |                                                      |
|=========+=====+======================================================|
		    ]]>
                </artwork>
            </figure>

            <section numbered="true" toc="default">
                <name>Key Formats</name>
                <t>
                    The private key format defined is from PKCS#8
                    <xref target="RFC5208" format="default"></xref>
                    .
                    PKCS#8 PrivateKeyInfo is defined as:
                </t>
                <artwork align="left" name="" type="" alt="">
                    <![CDATA[
   PrivateKeyInfo ::=  SEQUENCE {
       version               INTEGER             -- PKCS#8 syntax ver
       privateKeyAlgorithm   AlgorithmIdentifier -- see chapter above
       privateKey            OCTET STRING,       -- see chapter below
       attributes            [0]  IMPLICIT Attributes OPTIONAL
   }
		    ]]>
                </artwork>
		<t>Distributing a PQC private key requires a PKCS#8 PrivateKeyInfo with a joined PQC algorithm and algorithm parameter OID in the algorithm field of AlgorithmIdentifier and a PQC algorithm specific private key object in the privateKey field of PrivateKeyInfo.  Both objects are defined in the specific algorithm sections of this document.  For an overview see tables above and below.</t>
	    </section>
	    <section numbered="true" toc="default">
                <name>
                    Public Key Format based on
                    <xref target="RFC5280" format="default"></xref>
                </name>

                <t>RFC5280 subjectPublicKeyInfo is defined in as:</t>
                <artwork align="left" name="" type="" alt="">
                    <![CDATA[
   SubjectPublicKeyInfo := SEQUENCE {
       algorithm          AlgorithmIdentifier  -- see chapter above
       subjectPublicKey   BIT STRING           -- see chapter below
   }
		    ]]>
                </artwork>
                <t>Distributing a PQC public key requires a
		<xref target="RFC5480" format="default"></xref>
		subjectPublicKeyInfo with a joined PQC algorithm and algorithm parameter OID in the algorithm field of AlgorithmIdentifier and a PQC algorithm specific public key object in the subjectPublicKey field of subjectPublicKeyInfo.  Both objects are defined in the specific algorithm sections of this document.  For an overview see tables above and below.</t>
	    </section>
	    <section numbered="true" toc="default">
                <name>Overview of Memo Definitions - PQC Key Formats</name>
                <t>
		  The privateKey field in the PrivateKeyInfo type
                  <xref target="RFC5480" format="default"></xref>
		    is an OCTET STRING whose contents are the value of the private key.  The interpretation of the content differs from PQC algorithm to algorithm.  The subjectPublicKey field in the subjectPublicKeyInfo type
		    <xref target="RFC5480" format="default">RFC 5480</xref>
		    is a BIT STRING whose contents are the value of the public key.  Here also the interpretation of the content differs from PQC algorithm to algorithm.
		</t>
		<t>For an NTRU private key, for example, the content needs to be interpreted according to the NTRUPrivateKey type and for an NTRU public key the content needs to be interpreted according to the NTRUPublicKey type; both are defined in the NTRU chapter below.</t>
	    </section>

	</section>

	
	<section numbered="true" toc="default">
            <name>SPHINCS-PLUS</name>

            <t>SPHINCS-PLUS is a hash-based signature scheme. The algoritm is based on the hardness assumptions of its underlying hash functions, which can be chosen from the set Haraka, SHA-256 or SHAKE256.</t>
	    
	    <t>Project Website https://sphincs.org
	    NIST Round 3 Submission https://csrc.nist.gov/CSRC/media/Projects/post-quantum-cryptography/documents/round-3/submissions/SPHINCS-Round3.zip</t>

	    <section numbered="true" toc="default">
                <name>SPHINCS-PLUS Algorithm Parameter Identifiers</name>

                <t>Since the underlying hash function can be chosen, for each parameter set identified in the SPHINCS-PLUS specification in fact three parameter OIDs exist. The parameters are the same across the three parameter OIDs.</t>
                <figure anchor="SPHINCSPLUSOIDs">
                    <artwork align="left" name="" type="" alt="">
                        <![CDATA[
|=========================+=====================================|
| SPHINCS-PLUS-128s                                             |
|=========================+=====================================|
| Parameter OID           | {..*.. sphincsplus-sha-128s-r3}     | 
|                         | <.>                                 |
| NIST Level Security     | Level 1                             |
|-------------------------|-------------------------------------|
| Parameter OID           | {..*.. sphincsplus-shake-128s-r3}   | 
|                         | <.>                                 |
| NIST Level Security     | Level 1                             |
|-------------------------|-------------------------------------|
| Parameter OID           | {..*.. sphincsplus-haraka-128s-r3}  | 
|                         | <.>                                 |
| NIST Level Security     | Level 1                             |
|-------------------------|-------------------------------------|
| Parameters              | Security parameter n = 16           |
|                         | Hypertree height h = 63             |
|                         | Hypertree layers d = 7              |
|                         | FORS tree leaves log(t) = 12        |
|                         | Number of FORS trees k = 14         |
|                         | Winternitz parameter w = 16         |
|=========================+=====================================|
| SPHINCS-PLUS-128f                                             |
|=========================+=====================================|
| Parameter OID           | {..*.. sphincsplus-sha-128f-r3}     | 
|                         | <.>                                 |
| NIST Level Security     | Level 1                             |
|-------------------------|-------------------------------------|
| Parameter OID           | {..*.. sphincsplus-shake-128f-r3}   | 
|                         | <.>                                 |
| NIST Level Security     | Level 1                             |
|-------------------------|-------------------------------------|
| Parameter OID           | {..*.. sphincsplus-haraka-128f-r3}  | 
|                         | <.>                                 |
| NIST Level Security     | Level 1                             |
|-------------------------|-------------------------------------|
| Parameters              | Security parameter n = 16           |
|                         | Hypertree height h = 66             |
|                         | Hypertree layers d = 22             |
|                         | FORS tree leaves log(t) = 6         |
|                         | Number of FORS trees k = 33         |
|                         | Winternitz parameter w = 16         |
|=========================+=====================================|
| SPHINCS-PLUS-192s                                             |
|=========================+=====================================|
| Parameter OID           | {..*.. sphincsplus-sha-192s-r3}     | 
|                         | <.>                                 |
| NIST Level Security     | Level 3                             |
|-------------------------|-------------------------------------|
| Parameter OID           | {..*.. sphincsplus-shake-192s-r3}   | 
|                         | <.>                                 |
| NIST Level Security     | Level 3                             |
|-------------------------|-------------------------------------|
| Parameter OID           | {..*.. sphincsplus-haraka-192s-r3}  | 
|                         | <.>                                 |
| NIST Level Security     | Level 2                             |
|-------------------------|-------------------------------------|
| Parameters              | Security parameter n = 24           |
|                         | Hypertree height h = 63             |
|                         | Hypertree layers d = 7              |
|                         | FORS tree leaves log(t) = 14        |
|                         | Number of FORS trees k = 17         |
|                         | Winternitz parameter w = 16         |
|=========================+=====================================|
| SPHINCS-PLUS-192f                                             |
|=========================+=====================================|
| Parameter OID           | {..*.. sphincsplus-sha-192f-r3}     | 
|                         | <.>                                 |
| NIST Level Security     | Level 3                             |
|-------------------------|-------------------------------------|
| Parameter OID           | {..*.. sphincsplus-shake-192f-r3}   | 
|                         | <.>                                 |
| NIST Level Security     | Level 3                             |
|-------------------------|-------------------------------------|
| Parameter OID           | {..*.. sphincsplus-haraka-192f-r3}  | 
|                         | <.>                                 |
| NIST Level Security     | Level 2                             |
|-------------------------|-------------------------------------|
| Parameters              | Security parameter n = 24           |
|                         | Hypertree height h = 66             |
|                         | Hypertree layers d = 22             |
|                         | FORS tree leaves log(t) = 8         |
|                         | Number of FORS trees k = 33         |
|                         | Winternitz parameter w = 16         |
|=========================+=====================================|
| SPHINCS-PLUS-256s                                             |
|=========================+=====================================|
| Parameter OID           | {..*.. sphincsplus-sha-256s-r3}     | 
|                         | <.>                                 |
| NIST Level Security     | Level 5                             |
|-------------------------|-------------------------------------|
| Parameter OID           | {..*.. sphincsplus-shake-256s-r3}   | 
|                         | <.>                                 |
| NIST Level Security     | Level 5                             |
|-------------------------|-------------------------------------|
| Parameter OID           | {..*.. sphincsplus-haraka-256s-r3}  | 
|                         | <.>                                 |
| NIST Level Security     | Level 2                             |
|-------------------------|-------------------------------------|
| Parameters              | Security parameter n = 32           |
|                         | Hypertree height h = 64             |
|                         | Hypertree layers d = 8              |
|                         | FORS tree leaves log(t) = 14        |
|                         | Number of FORS trees k = 22         |
|                         | Winternitz parameter w = 16         |
|=========================+=====================================|
| SPHINCS-PLUS-256f                                             |
|=========================+=====================================|
| Parameter OID           | {..*.. sphincsplus-sha-256f-r3}     | 
|                         | <.>                                 |
| NIST Level Security     | Level 5                             |
|-------------------------|-------------------------------------|
| Parameter OID           | {..*.. sphincsplus-shake-256f-r3}   | 
|                         | <.>                                 |
| NIST Level Security     | Level 5                             |
|-------------------------|-------------------------------------|
| Parameter OID           | {..*.. sphincsplus-haraka-256f-r3}  | 
|                         | <.>                                 |
| NIST Level Security     | Level 2                             |
|-------------------------|-------------------------------------|
| Parameters              | Security parameter n = 32           |
|                         | Hypertree height h = 68             |
|                         | Hypertree layers d = 17             |
|                         | FORS tree leaves log(t) = 9         |
|                         | Number of FORS trees k = 35         |
|                         | Winternitz parameter w = 16         |
|=========================+=====================================|
			]]>
                    </artwork>
                </figure>

            </section>
            <section numbered="true" toc="default">
                <name>SPHINCS-PLUS Key Details</name>
                <t>The SPHINCS-PLUS secret key contains 4 n-byte components SK.seed, SK.prf, PK.seed and PK.root. The latter 2 components are equivalent to the SPHINCS-PLUS public key.</t>

		<figure anchor="SPHINCSPLUSPrivatKeySizes">
                    <artwork align="left" name="" type="" alt="">
                        <![CDATA[
|============================+=========+==========|
| Algorithm OID              | Params  |   Secret |
|                            |         |   Key    |
|                            |         |   Length |
|============================+=========+==========+
| sphincsplus-sha-128s-r3    |  n=16   |    64    |
| sphincsplus-sha-128f-r3    |         |          |
| sphincsplus-shake-128s-r3  |         |          |
| sphincsplus-shake-128f-r3  |         |          |
| sphincsplus-haraka-128s-r3 |         |          |
| sphincsplus-haraka-128f-r3 |         |          |
|============================+=========+==========+
| sphincsplus-sha-192s-r3    |  n=24   |    96    |
| sphincsplus-sha-192f-r3    |         |          |
| sphincsplus-shake-192s-r3  |         |          |
| sphincsplus-shake-192f-r3  |         |          |
| sphincsplus-haraka-192s-r3 |         |          |
| sphincsplus-haraka-192f-r3 |         |          |
|============================+=========+==========+
| sphincsplus-sha-256s-r3    |  n=32   |    128   |
| sphincsplus-sha-256f-r3    |         |          |
| sphincsplus-shake-256s-r3  |         |          |
| sphincsplus-shake-256f-r3  |         |          |
| sphincsplus-haraka-256s-r3 |         |          |
| sphincsplus-haraka-256f-r3 |         |          |
|============================+=========+==========+
			]]>
                    </artwork>
                </figure>
	    </section>

	    <section numbered="true" toc="default">
                <name>SPHINCS-PLUS Secret Key Full Encoding</name>
                <t>Encoding a SPHINCS-PLUS private key with PKCS#8 must include the following two fields:</t>
                <ul spacing="compact">
                    <li>sphincsplus-(hash)-(params)-r3 in the algorithm field of AlgorithmIdentifier</li>
		    <li>SPHINCSPLUSPrivateKey in the privateKey field, which is an OCTET STRING.</li>
		</ul>
		<t>For a signing operation of SPHINCS-PLUS the PK.seed of the Public Key is required. Therefore the SPHINCS-PLUS public key is included in the distributed PrivateKeyInfo, and the PublicKey field in SPHINCSPLUSPrivateKey is used (see description of SPHINCSPLUSPublicKey below).</t>

		<t>ASN.1 Encoding for a SPHINCS-PLUS secret key:</t>
		                <artwork name="" type="" align="left" alt="">
                    <![CDATA[
  SPHINCSPLUSPrivateKey ::= SEQUENCE {
    version          INTEGER {v2(1)}     --syntax version 2 (round 3)
    skseed          OCTET STRING,        --n-byte private key seed
    skprf           OCTET STRING,        --n-byte private key seed 
    PublicKey       SPHINCSPLUSPublicKey --public key
  }
		    ]]>
                </artwork>

            </section>
            <section numbered="true" toc="default">
                <name>SPHINCS-PLUS Public Key Full Encoding</name>

                <t>The SPHINCS-PLUS public key contains 2 n-byte components PK.seed and PK.root.</t>
		
		<figure anchor="DilithiumKeyPublicSizes">
                    <artwork align="left" name="" type="" alt="">
                        <![CDATA[
|============================+=========+==========|
| Algorithm OID              | Params  |   Secret |
|                            |         |   Key    |
|                            |         |   Length |
|============================+=========+==========+
| sphincsplus-sha-128s-r3    |  n=16   |    32    |
| sphincsplus-sha-128f-r3    |         |          |
| sphincsplus-shake-128s-r3  |         |          |
| sphincsplus-shake-128f-r3  |         |          |
| sphincsplus-haraka-128s-r3 |         |          |
| sphincsplus-haraka-128f-r3 |         |          |
|============================+=========+==========+
| sphincsplus-sha-192s-r3    |  n=24   |    48    |
| sphincsplus-sha-192f-r3    |         |          |
| sphincsplus-shake-192s-r3  |         |          |
| sphincsplus-shake-192f-r3  |         |          |
| sphincsplus-haraka-192s-r3 |         |          |
| sphincsplus-haraka-192f-r3 |         |          |
|============================+=========+==========+
| sphincsplus-sha-256s-r3    |  n=32   |    64    |
| sphincsplus-sha-256f-r3    |         |          |
| sphincsplus-shake-256s-r3  |         |          |
| sphincsplus-shake-256f-r3  |         |          |
| sphincsplus-haraka-256s-r3 |         |          |
| sphincsplus-haraka-256f-r3 |         |          |
|============================+=========+==========+
]]>
                    </artwork>
                </figure>

		<artwork name="" type="" align="left" alt="">
                    <![CDATA[
  SPHINCSPPLUSPublicKey := SEQUENCE {
    pkseed          OCTET STRING,     --n-byte public key seed
    pkroot          OCTET STRING      --n-byte public hypertree root
  }
]]>
                </artwork>
            </section>
        </section>


        <section anchor="Acknowledgements" numbered="true" toc="default">
            <name>Acknowledgements</name>
            <t>This template was derived from an initial version written by Pekka
        Savola and contributed by him to the xml2rfc project.</t>
            <t>This document is part of a plan to make xml2rfc indispensable.</t>
        </section>
        <!-- Possibly a 'Contributors' section ... -->

        <section anchor="IANA" numbered="true" toc="default">
            <name>IANA Considerations</name>
            <t>This memo includes no request to IANA.</t>
        </section>
        <section anchor="Security" numbered="true" toc="default">
            <name>Security Considerations</name>
            <t>Any processing of the ASN.1 private key structures, such as base64 en/decoding shall be performed in "constant-time", meaning without secret-dependent control flow and table lookups.
        The ASN.1 structures in this document are defined with fixed tag-lengths. The purpose is to prevent side-channel leakage of variable lengths during DER parsing. Any DER parsing of the private key ASN.1 key structures shall be performed with these fixed lengths.</t>
        </section>
    </middle>
    <!--  *****BACK MATTER ***** -->

    <back>
        <!-- References split into informative and normative -->

        <!-- There are 2 ways to insert reference entries from the citation libraries:
    1. define an ENTITY at the top, and use "ampersand character"RFC2629; here (as shown)
    2. simply use a PI "less than character"?rfc include="reference.RFC.2119.xml"?> here
    (for I-Ds: include="reference.I-D.narten-iana-considerations-rfc2434bis.xml")
    
    Both are cited textually in the same manner: by using xref elements.
    If you use the PI option, xml2rfc will, by default, try to find included files in the same
    directory as the including file. You can also define the XML_LIBRARY environment variable
    with a value containing a set of directories to search.  These can be either in the local
    filing system or remote ones accessed by http (http://domain/dir/... ).-->

        <references>
            <name>References</name>
            <references>
                <name>Normative References</name>

                <!--?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml"?-->
                <reference anchor="RFC2119" target="https://www.rfc-editor.org/info/rfc2119" xml:base="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
                    <front>
                        <title>Key words for use in RFCs to Indicate Requirement Levels</title>
                        <seriesInfo name="DOI" value="10.17487/RFC2119" />
                        <seriesInfo name="RFC" value="2119" />
                        <seriesInfo name="BCP" value="14" />
                        <author initials="S." surname="Bradner" fullname="S. Bradner">
                            <organization />
                        </author>
                        <date year="1997" month="March" />
                        <abstract>
                            <t>In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized. This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
                        </abstract>
                    </front>
                </reference>


                <!--?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.5208.xml"?-->
                <reference anchor="RFC5208" target="hhttps://www.rfc-editor.org/info/rfc5208" xml:base="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.5208.xml">
                    <front>
                        <title>Public-Key Cryptography Standards (PKCS) #8: Private-Key Information Syntax Specification Version 1.2</title>
                        <seriesInfo name="DOI" value="10.17487/RFC5208" />
                        <seriesInfo name="RFC" value="5208" />
                        <seriesInfo name="BCP" value="14" />
                        <author initials="B." surname="Kaliski" fullname="B. Kaliski">
                            <organization />
                        </author>
                        <date year="2008" month="May" />
                        <abstract>
                            <t></t>
                        </abstract>
                    </front>
                </reference>

                <!--?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.RFC5280.xml"?-->
                <reference anchor="RFC5280" target="hhttps://www.rfc-editor.org/info/rfcRFC5280" xml:base="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.RFC5280.xml">
                    <front>
                        <title>Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</title>
                        <seriesInfo name="DOI" value="10.17487/RFC5280" />
                        <seriesInfo name="RFC" value="RFC5280" />
                        <seriesInfo name="BCP" value="14" />
                        <author initials="D." surname="Cooper" fullname="D. Cooper">
                            <organization />
                        </author>
                        <date year="2008" month="May" />
                        <abstract>
                            <t></t>
                        </abstract>
                    </front>
                </reference>


                <!--?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.RFC5480.xml"?-->
                <reference anchor="RFC5480" target="hhttps://www.rfc-editor.org/info/rfc5480" xml:base="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.RFC5480.xml">
                    <front>
                        <title>Elliptic Curve Cryptography Subject Public Key Information</title>
                        <seriesInfo name="DOI" value="10.17487/RFC5480" />
                        <seriesInfo name="RFC" value="RFC5480" />
                        <seriesInfo name="BCP" value="14" />
                        <author initials="S." surname="Turner" fullname="S. Turner">
                            <organization />
                        </author>
                        <date year="2009" month="May" />
                        <abstract>
                            <t></t>
                        </abstract>
                    </front>
                </reference>

            </references>
            <references>
                <name>Informative References</name>
                <!-- Here we use entities that we defined at the beginning. -->

                <reference anchor="RFC2629" target="https://www.rfc-editor.org/info/rfc2629" xml:base="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2629.xml">
                    <front>
                        <title>Writing I-Ds and RFCs using XML</title>
                        <seriesInfo name="DOI" value="10.17487/RFC2629" />
                        <seriesInfo name="RFC" value="2629" />
                        <author initials="M." surname="Rose" fullname="M. Rose">
                            <organization />
                        </author>
                        <date year="1999" month="June" />
                        <abstract>
                            <t>This memo presents a technique for using XML (Extensible Markup Language) as a source format for documents in the Internet-Drafts (I-Ds) and Request for Comments (RFC) series.  This memo provides information for the Internet community.</t>
                        </abstract>
                    </front>
                </reference>
                <reference anchor="RFC3552" target="https://www.rfc-editor.org/info/rfc3552" xml:base="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.3552.xml">
                    <front>
                        <title>Guidelines for Writing RFC Text on Security Considerations</title>
                        <seriesInfo name="DOI" value="10.17487/RFC3552" />
                        <seriesInfo name="RFC" value="3552" />
                        <seriesInfo name="BCP" value="72" />
                        <author initials="E." surname="Rescorla" fullname="E. Rescorla">
                            <organization />
                        </author>
                        <author initials="B." surname="Korver" fullname="B. Korver">
                            <organization />
                        </author>
                        <date year="2003" month="July" />
                        <abstract>
                            <t>All RFCs are required to have a Security Considerations section. Historically, such sections have been relatively weak.  This document provides guidelines to RFC authors on how to write a good Security Considerations section.   This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
                        </abstract>
                    </front>
                </reference>
                <reference anchor="RFC5226" target="https://www.rfc-editor.org/info/rfc5226" xml:base="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.5226.xml">
                    <front>
                        <title>Guidelines for Writing an IANA Considerations Section in RFCs</title>
                        <seriesInfo name="DOI" value="10.17487/RFC5226" />
                        <seriesInfo name="RFC" value="5226" />

                        <author initials="T." surname="Narten" fullname="T. Narten">
                            <organization />
                        </author>

                        <author initials="H." surname="Alvestrand" fullname="H. Alvestrand">
                            <organization />
                        </author>

                        <date year="2008" month="May" />
                        <abstract>
                            <t>This RFC addresses key identification, key serialization, and key compression for the set of quantum safe algorithms currently under evaluation in the NIST PQC process. The aim of this RFC is to facilitate the management of key material as these algorithms evolve through standardization phases into production. Early definition of key material is expected to expedite the adoption of new quantum safe algorithms at the same time as improving interoperability and preventing diverging standards. </t>

                        </abstract>
                    </front>
                </reference>
                <!-- A reference written by by an organization not a person. -->


            </references>
        </references>


        <section anchor="app-additional" numbered="true" toc="default">
            <name>Additional Stuff</name>
            <t>This becomes an Appendix.</t>
        </section>
        <!-- Change Log
    
    v00 2006-03-15  EBD   Initial version
    
    v01 2006-04-03  EBD   Moved PI location back to position 1 -
    v3.1 of XMLmind is better with them at this location.
    v02 2007-03-07  AH    removed extraneous nested_list attribute,
    other minor corrections
    v03 2007-03-09  EBD   Added comments on null IANA sections and fixed heading capitalization.
    Modified comments around figure to reflect non-implementation of
    figure indent control.  Put in reference using anchor="DOMINATION".
    Fixed up the date specification comments to reflect current truth.
    v04 2007-03-09 AH     Major changes: shortened discussion of PIs,
    added discussion of rfc include.
    v05 2007-03-10 EBD    Added preamble to C program example to tell about ABNF and alternative
    images. Removed meta-characters from comments (causes problems).
    
    v06 2010-04-01 TT     Changed ipr attribute values to latest ones. Changed date to
    year only, to be consistent with the comments. Updated the
    IANA guidelines reference from the I-D to the finished RFC.
    v07 2020-01-21 HL    Converted the template to use XML schema version 3.
    -->
    </back>
</rfc>
